nohup: ignoring input
[0;34m
==========================================
Lightning Prediction Model Pipeline
==========================================
[0m
[0;34m==== Validating Input Files and Directories ====[0m
[0;32mâœ“ All input validation passed[0m
[0;34m==== Setting Up Directory Structure ====[0m
[0;32mâœ“ Directory structure ready[0m
[0;34m==== Setting Up Monitoring ====[0m
Tensorboard is available. To monitor training, run:
  tensorboard --logdir logs

Log locations:
  Training logs: logs/
  Experiment logs: experiments/lightning_cape_seasonal_20250709_122632/logs/
  Checkpoints: experiments/lightning_cape_seasonal_20250709_122632/checkpoints/
[1;33mâš  Skipping data preprocessing[0m
[0;34m==== Training Lightning Prediction Model ====[0m
Experiment name: lightning_cape_seasonal_20250709_122632
Configuration: config

[0;32mâœ“ GPU detected - training will use CUDA[0m
NVIDIA GeForce RTX 3070 Laptop GPU, 8192

Seed set to 42
2025-07-09 12:26:35,403 - __main__ - INFO - Loaded configuration from config
2025-07-09 12:26:35,420 - __main__ - INFO - Configuration validation completed
2025-07-09 12:26:35,421 - __main__ - INFO - Created directories for experiment: lightning_cape_seasonal_20250709_122632
2025-07-09 12:26:35,426 - __main__ - INFO - Saved experiment configuration to experiments/lightning_cape_seasonal_20250709_122632/config.yaml
2025-07-09 12:26:35,426 - __main__ - INFO - Initializing data module...
2025-07-09 12:26:35,426 - src.data.data_loader - INFO - Setting up data for stage: fit
2025-07-09 12:26:35,429 - src.data.data_loader - INFO - Loaded 24 train, 4 val, 8 test file pairs
2025-07-09 12:26:35,429 - src.data.data_loader - INFO - Setting up data preprocessor...
2025-07-09 12:26:35,429 - src.data.preprocessing - INFO - Computing normalization statistics for cape
2025-07-09 12:26:35,597 - src.data.preprocessing - INFO - cape normalization stats: {'mean': 582.4618530273438, 'std': 958.6071166992188}
2025-07-09 12:26:35,598 - src.data.preprocessing - INFO - Computing normalization statistics for terrain
2025-07-09 12:26:35,602 - src.data.preprocessing - INFO - terrain normalization stats: {'mean': 248.5579071044922, 'std': 252.46376037597656}
2025-07-09 12:26:35,602 - src.data.data_loader - INFO - CAPE stats: {'mean': 582.4618530273438, 'std': 958.6071166992188}
2025-07-09 12:26:35,602 - src.data.data_loader - INFO - Terrain stats: {'mean': 248.5579071044922, 'std': 252.46376037597656}
2025-07-09 12:26:35,602 - src.data.dataset - INFO - Building dataset sample index...
2025-07-09 12:26:35,757 - src.data.dataset - INFO - Built dataset index with 17592 samples
2025-07-09 12:26:35,757 - src.data.dataset - INFO - Building dataset sample index...
2025-07-09 12:26:35,782 - src.data.dataset - INFO - Built dataset index with 2928 samples
2025-07-09 12:26:35,782 - __main__ - INFO - Data module initialized with 24 train files
2025-07-09 12:26:35,806 - __main__ - INFO - Sample batch shapes:
2025-07-09 12:26:35,806 - __main__ - INFO -   cape: torch.Size([1, 19, 26])
2025-07-09 12:26:35,806 - __main__ - INFO -   terrain: torch.Size([1, 710, 710])
2025-07-09 12:26:35,806 - __main__ - INFO -   lightning: torch.Size([181, 221])
2025-07-09 12:26:35,806 - __main__ - INFO - Creating trainer and model...
/home/dev/WRF/miniconda3/envs/lightning-pred/lib/python3.8/site-packages/lightning_fabric/connector.py:571: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
`Trainer(val_check_interval=1.0)` was configured so validation will run at the end of the training epoch..
2025-07-09 12:26:35,945 - __main__ - INFO - Model created:
2025-07-09 12:26:35,945 - __main__ - INFO -   Total parameters: 25,168,643
2025-07-09 12:26:35,945 - __main__ - INFO -   Model size: 96.0 MB
2025-07-09 12:26:35,945 - __main__ - INFO -   CAPE-only mode: True
2025-07-09 12:26:35,945 - __main__ - INFO - Starting training...
2025-07-09 12:26:35,945 - __main__ - INFO - Testing data loading...
2025-07-09 12:26:35,945 - __main__ - INFO - Train dataloader created successfully
2025-07-09 12:26:35,945 - __main__ - INFO - Attempting to get first batch...
   âœ“ Encoders built (CAPE: 256ch, Terrain: 64ch)
   âœ“ Fusion modules built (Output: 512ch)
   âœ“ Core processing built (GNN: 256ch, Transformer: 256ch)
   âœ“ Prediction head built (Output: 1ch)
   âœ“ Domain adaptation built
âœ… Lightning Prediction Model initialized
   - CAPE-only mode: True
   - Domain adaptation: True
   - Physics constraints: True
Lightning Trainer initialized:
  - Model parameters: 25,168,643
  - Gradient accumulation: 4 steps
  - Domain adaptation: True
  - Physics loss weight: 0.1
2025-07-09 12:26:36,208 - __main__ - INFO - First batch loaded successfully
2025-07-09 12:26:36,209 - __main__ - INFO - Batch keys: ['cape', 'terrain', 'lightning', 'file_idx', 'time_start']
2025-07-09 12:26:36,209 - __main__ - INFO -   cape: torch.Size([4, 1, 19, 26]) (torch.float32)
2025-07-09 12:26:36,209 - __main__ - INFO -   terrain: torch.Size([4, 1, 710, 710]) (torch.float32)
2025-07-09 12:26:36,209 - __main__ - INFO -   lightning: torch.Size([4, 181, 221]) (torch.float32)
2025-07-09 12:26:36,209 - __main__ - INFO -   file_idx: torch.Size([4]) (torch.int64)
2025-07-09 12:26:36,209 - __main__ - INFO -   time_start: torch.Size([4]) (torch.int64)
2025-07-09 12:26:36,209 - __main__ - INFO - Testing model forward pass...
2025-07-09 12:26:38,462 - __main__ - ERROR - Model forward pass failed: Given groups=1, weight of size [64, 64, 4, 4], expected input[4, 96, 710, 710] to have 64 channels, but got 96 channels instead
